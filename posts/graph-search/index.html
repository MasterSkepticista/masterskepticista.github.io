<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=light data-auto-appearance=true><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#FFFFFF"><title>Graph Search &#183; Home</title>
<meta name=title content="Graph Search &#183; Home"><script type=text/javascript src=/js/appearance.min.8a082f81b27f3cb2ee528df0b0bdc39787034cf2cc34d4669fbc9977c929023c.js integrity="sha256-iggvgbJ/PLLuUo3wsL3Dl4cDTPLMNNRmn7yZd8kpAjw="></script><link type=text/css rel=stylesheet href=/css/main.bundle.min.e0c75b2446b3f8545af40deeeebc2b7899e8a610754fea305617e08710cee268.css integrity="sha256-4MdbJEaz+FRa9A3u7rwreJnophB1T+owVhfghxDO4mg="><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.af5d9722112bedac95702865c340bcd6286c4e9b2c15ce26b531ea1fba974cb8.js integrity="sha256-r12XIhEr7ayVcChlw0C81ihsTpssFc4mtTHqH7qXTLg=" data-copy=Copy data-copied=Copied></script><meta name=description content="
      
        Time for an algorithm shopping spree.
      
    "><link rel=canonical href=https://masterskepticista.github.io/posts/graph-search/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://masterskepticista.github.io/posts/graph-search/"><meta property="og:site_name" content="Home"><meta property="og:title" content="Graph Search"><meta property="og:description" content="Time for an algorithm shopping spree."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-08-27T00:00:00+00:00"><meta property="article:modified_time" content="2024-08-27T00:00:00+00:00"><meta property="article:tag" content="Topological Sort"><meta property="article:tag" content="Graph Search"><meta property="article:tag" content="Depth-First Search"><meta property="article:tag" content="Breadth-First Search"><meta name=twitter:card content="summary"><meta name=twitter:title content="Graph Search"><meta name=twitter:description content="Time for an algorithm shopping spree."><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"Graph Search","headline":"Graph Search","abstract":"Time for an algorithm shopping spree.","inLanguage":"en","url":"https:\/\/masterskepticista.github.io\/posts\/graph-search\/","author":{"@type":"Person","name":"Karan Shah"},"copyrightYear":"2024","dateCreated":"2024-08-27T00:00:00\u002b00:00","datePublished":"2024-08-27T00:00:00\u002b00:00","dateModified":"2024-08-27T00:00:00\u002b00:00","keywords":["topological sort","graph search","depth-first search","breadth-first search"],"mainEntityOfPage":"true","wordCount":"1940"}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://masterskepticista.github.io/","name":"","position":1},{"@type":"ListItem","item":"https://masterskepticista.github.io/posts/","name":"Posts","position":2},{"@type":"ListItem","name":"Graph Search","position":3}]}</script><meta name=author content="Karan Shah"><link href=https://masterskepticista.github.io/ rel=me><link href=https://github.com/MasterSkepticista rel=me><link href="https://scholar.google.com/citations?user=vEgcRTkAAAAJ&amp;hl=en" rel=me><link href=https://linkedin.com/in/karan-bhavesh-shah rel=me><link href=https://stackoverflow.com/users/9230398/karan-shah rel=me><link href=https://twitter.com/elevated_quark rel=me><link type=text/css rel=stylesheet href=/lib/katex/katex.min.68e17230ccd917b97b7a2def38a8108918599d8aa4f580bfb8cce5e13d23e4de43dcaba5f9000553cb2c10d0d1300aabfe5c433a3305ebd752609f0762a63e59.css integrity="sha512-aOFyMMzZF7l7ei3vOKgQiRhZnYqk9YC/uMzl4T0j5N5D3Kul+QAFU8ssENDRMAqr/lxDOjMF69dSYJ8HYqY+WQ=="><script defer src=/lib/katex/katex.min.50f14e69d6a8da7128ae3b63974c544ed377c36d096b5e3750f114e84c89d668b9301d9b0ed3248969aa183aa2e3bc4d2c1e73d5dcb7d462890c45a18d424589.js integrity="sha512-UPFOadao2nEorjtjl0xUTtN3w20Ja143UPEU6EyJ1mi5MB2bDtMkiWmqGDqi47xNLB5z1dy31GKJDEWhjUJFiQ=="></script><script defer src=/lib/katex/auto-render.min.6095714e3aadb63b14ddc4af69346ab12974c1b460654345f8d1860a0b68fcc51b22f68b757433193090bb80afc8965b65cb607e5541d0f5f0f4b2e64d69b9ff.js integrity="sha512-YJVxTjqttjsU3cSvaTRqsSl0wbRgZUNF+NGGCgto/MUbIvaLdXQzGTCQu4CvyJZbZctgflVB0PXw9LLmTWm5/w==" onload=renderMathInElement(document.body)></script></head><body class="m-auto flex h-screen max-w-7xl flex-col bg-neutral px-6 text-lg leading-7 text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"><div id=the-top class="absolute flex self-center"><a class="-translate-y-8 rounded-b-lg bg-primary-200 px-3 py-1 text-sm focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="pe-2 font-bold text-primary-600 dark:text-primary-400">&darr;</span>Skip to main content</a></div><header class="py-6 font-semibold text-neutral-900 dark:text-neutral sm:py-10 print:hidden"><nav class="flex items-start justify-between sm:items-center"><div class="flex flex-row items-center"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" rel=me href=/>Home</a></div><ul class="flex list-none flex-col text-end sm:flex-row"><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><a href=/posts/ title><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Blog</span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><a href=/tags/ title><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Tags</span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5"><button id=search-button-1 title="Search (/)">
<span class="group-dark:hover:text-primary-400 transition-colors group-hover:text-primary-600"><span class="icon relative inline-block px-1 align-text-bottom"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span></button></li></ul></nav></header><div class="relative flex grow flex-col"><main id=main-content class=grow><article><header class=max-w-prose><h1 class="mb-8 mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">Graph Search</h1><div class="mb-10 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2024-08-27 00:00:00 +0000 UTC">27 August 2024</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">10 mins</span></div></div></header><section class="prose mt-0 flex max-w-full flex-col dark:prose-invert lg:flex-row"><div class="order-first px-0 lg:order-last lg:max-w-xs lg:ps-8"><div class="toc pe-5 lg:sticky lg:top-10 print:hidden"><details open class="-ms-5 mt-0 overflow-hidden rounded-lg ps-5"><summary class="block cursor-pointer bg-neutral-100 py-1 ps-5 text-lg font-semibold text-neutral-800 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="border-s border-dotted border-neutral-300 py-2 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#toy-problem>Toy Problem</a></li><li><a href=#depth-first-search>Depth-First Search</a></li><li><a href=#breadth-first-search>Breadth-First Search</a></li><li><a href=#topological-sort>Topological Sort</a></li><li><a href=#we-knew-it-all-along-didnt-we>We knew it all along, didn&rsquo;t we?</a></li></ul></nav></div></details></div></div><div class="min-h-0 min-w-0 max-w-prose grow"><p>While diving into autograd internals, I had to pause at Topological sort — an important step in backpropagation. Studying it alone felt like buying a single sock. Since I would have to brush up on Depth-First Search anyway (Topological sort&rsquo;s older sibling), I decided to also toss Breadth-First Search into the cart. After all, who goes shopping for algorithms and leaves with just one?</p><h2 id=toy-problem class="relative group">Toy Problem <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#toy-problem aria-label=Anchor>#</a></span></h2><p>We will pick a problem of finding a path from the origin (top-left) to the sink (bottom-right) of a randomly generated maze. Our definition of a maze, here, is a mesh of cells with distinct paths that can (or cannot) be traversed. It can be encoded as a graph. There are <a href=https://en.wikipedia.org/wiki/Graph_%28abstract_data_type%29#Common_data_structures_for_graph_representation target=_blank rel=noreferrer>several</a> ways to encode a graph. We will encode ours as an adjacency matrix, with <code>1</code> representing a wall and <code>0</code> representing a pathway.</p><div class="flex rounded-md bg-primary-100 px-4 py-3 dark:bg-primary-900"><span class="pe-3 text-primary-400"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M256 0C114.6.0.0 114.6.0 256s114.6 256 256 256 256-114.6 256-256S397.4.0 256 0zm0 128c17.67.0 32 14.33 32 32 0 17.67-14.33 32-32 32s-32-14.3-32-32 14.3-32 32-32zm40 256h-80c-13.2.0-24-10.7-24-24s10.75-24 24-24h16v-64h-8c-13.25.0-24-10.75-24-24s10.8-24 24-24h32c13.25.0 24 10.75 24 24v88h16c13.25.0 24 10.75 24 24s-10.7 24-24 24z"/></svg>
</span></span><span class=dark:text-neutral-300>Tip: Execute these cells in a notebook for an auto-updating plot.</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>draw</span><span class=p>(</span><span class=n>maze</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;&#34;&#34;Auto-updating plot.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>  <span class=n>display</span><span class=o>.</span><span class=n>clear_output</span><span class=p>(</span><span class=n>wait</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>4</span><span class=p>,</span> <span class=mi>4</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=n>plt</span><span class=o>.</span><span class=n>axis</span><span class=p>(</span><span class=s2>&#34;off&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>plt</span><span class=o>.</span><span class=n>imshow</span><span class=p>(</span><span class=n>maze</span><span class=p>,</span> <span class=n>cmap</span><span class=o>=</span><span class=s2>&#34;plasma_r&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></div><p>I will use a simple recusive backtracking algorithm to generate mazes. <a href=https://weblog.jamisbuck.org/2011/2/7/maze-generation-algorithm-recap target=_blank rel=noreferrer>Here</a> is a goldmine of other algorithms (with beautiful animations) for the curious mind.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>generate_maze</span><span class=p>(</span><span class=n>n</span><span class=p>:</span> <span class=nb>int</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;&#34;&#34;Generates a random N*N maze using recursive backtracking.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>  <span class=c1># Make `n` odd. Why?</span>
</span></span><span class=line><span class=cl>  <span class=n>n</span> <span class=o>-=</span> <span class=p>(</span><span class=n>n</span> <span class=o>%</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>n</span> <span class=o>+=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>  <span class=n>maze</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>ones</span><span class=p>((</span><span class=n>n</span><span class=p>,</span> <span class=n>n</span><span class=p>),</span> <span class=n>dtype</span><span class=o>=</span><span class=n>np</span><span class=o>.</span><span class=n>int32</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1># Opening at the top and bottom. We choose these points</span>
</span></span><span class=line><span class=cl>  <span class=c1># because we can guarantee that an odd-maze will </span>
</span></span><span class=line><span class=cl>  <span class=c1># not have doubly-thick walls.</span>
</span></span><span class=line><span class=cl>  <span class=n>maze</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=n>maze</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>][</span><span class=o>-</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1># Direction vectors. Moving by 2 units ensures</span>
</span></span><span class=line><span class=cl>  <span class=c1># that we skip over the walls and move from one </span>
</span></span><span class=line><span class=cl>  <span class=c1># potential passage to next.</span>
</span></span><span class=line><span class=cl>  <span class=n>directions</span> <span class=o>=</span> <span class=p>[(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>2</span><span class=p>),</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>2</span><span class=p>),</span> <span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=p>(</span><span class=o>-</span><span class=mi>2</span><span class=p>,</span> <span class=mi>0</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1># Choose a random odd coordinate.</span>
</span></span><span class=line><span class=cl>  <span class=n>start</span> <span class=o>=</span> <span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>randrange</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=mi>2</span><span class=p>),</span> <span class=n>random</span><span class=o>.</span><span class=n>randrange</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>n</span><span class=p>,</span> <span class=mi>2</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=n>maze</span><span class=p>[</span><span class=n>start</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>  <span class=n>stack</span> <span class=o>=</span> <span class=p>[</span><span class=n>start</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>while</span> <span class=n>stack</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>cy</span><span class=p>,</span> <span class=n>cx</span> <span class=o>=</span> <span class=n>stack</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Get neighbors in a random order.</span>
</span></span><span class=line><span class=cl>    <span class=n>random</span><span class=o>.</span><span class=n>shuffle</span><span class=p>(</span><span class=n>directions</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>found_unvisited_neighbor</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>dx</span><span class=p>,</span> <span class=n>dy</span> <span class=ow>in</span> <span class=n>directions</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>nx</span><span class=p>,</span> <span class=n>ny</span> <span class=o>=</span> <span class=n>cx</span> <span class=o>+</span> <span class=n>dx</span><span class=p>,</span> <span class=n>cy</span> <span class=o>+</span> <span class=n>dy</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      <span class=c1># Check if the candidate cell is not out of bounds and is a wall.</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=mi>0</span> <span class=o>&lt;=</span> <span class=n>nx</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=ow>and</span> <span class=mi>0</span> <span class=o>&lt;=</span> <span class=n>ny</span> <span class=o>&lt;</span> <span class=n>n</span> <span class=ow>and</span> <span class=n>maze</span><span class=p>[</span><span class=n>ny</span><span class=p>][</span><span class=n>nx</span><span class=p>]</span> <span class=o>==</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=c1># Pave thru the wall.</span>
</span></span><span class=line><span class=cl>        <span class=n>maze</span><span class=p>[</span><span class=n>ny</span><span class=p>][</span><span class=n>nx</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=n>maze</span><span class=p>[</span><span class=n>cy</span> <span class=o>+</span> <span class=n>dy</span> <span class=o>//</span> <span class=mi>2</span><span class=p>][</span><span class=n>cx</span> <span class=o>+</span> <span class=n>dx</span> <span class=o>//</span> <span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=mi>0</span>
</span></span><span class=line><span class=cl>        <span class=c1># Append new location for paving</span>
</span></span><span class=line><span class=cl>        <span class=n>stack</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>ny</span><span class=p>,</span> <span class=n>nx</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>found_unvisited_neighbor</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>        <span class=k>break</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Backtrack if all neighbors have been visited.</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=ow>not</span> <span class=n>found_unvisited_neighbor</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>stack</span><span class=o>.</span><span class=n>pop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>maze</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=mi>42</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>maze</span> <span class=o>=</span> <span class=n>generate_maze</span><span class=p>(</span><span class=mi>50</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>draw</span><span class=p>(</span><span class=n>maze</span><span class=p>)</span>
</span></span></code></pre></div><figure class="mx-auto my-0 rounded-md"><img src=/posts/graph-search/maze.png alt="Maze example" class="mx-auto my-0 rounded-md"></figure><p>Our goal is to search for a path from the origin (top-left) to sink (bottom-right). During our maze traversal, we are free to explore neighbors one step away.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_neighbors</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>x</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=n>y</span> <span class=o>+</span> <span class=n>dy</span><span class=p>,</span> <span class=n>x</span> <span class=o>+</span> <span class=n>dx</span><span class=p>)</span> 
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>dy</span><span class=p>,</span> <span class=n>dx</span> <span class=ow>in</span> <span class=p>[(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=mi>0</span><span class=p>),</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=o>-</span><span class=mi>1</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span></code></pre></div><h2 id=depth-first-search class="relative group">Depth-First Search <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#depth-first-search aria-label=Anchor>#</a></span></h2><p>A key feature of this algorithm is that it exhaustively searches through all possible sub-vertices connected to a given vertex, before backtracking and moving to a different vertex at the same level. It is oblivious to how close it might be to its goal. Other words, even if it is <em>very</em> close to a solution, and then yeets off to a random sub-vertex, it will not return until it has exhaustively searched the dead end.</p><figure class="mx-auto my-0 rounded-md"><img src=https://imgs.xkcd.com/comics/dfs.png alt="DFS XKCD" class="mx-auto my-0 rounded-md"></figure><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>dfs</span><span class=p>(</span><span class=n>graph</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>start</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>end</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>2</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>visualize</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;&#34;&#34;Checks if a path exists between `start` and `end`.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>  <span class=n>visited</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>graph</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>bool_</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>candidates</span> <span class=o>=</span> <span class=p>[</span><span class=n>start</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=n>visited</span><span class=p>[</span><span class=n>start</span><span class=p>]</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>found</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>  <span class=k>while</span> <span class=n>candidates</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>visualize</span><span class=p>:</span> <span class=n>draw</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>visited</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>,</span> <span class=n>maze</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Pick the most recent candidate, i.e. LIFO    </span>
</span></span><span class=line><span class=cl>    <span class=n>cy</span><span class=p>,</span> <span class=n>cx</span> <span class=o>=</span> <span class=n>candidates</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>visited</span><span class=p>[</span><span class=n>end</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>      <span class=n>found</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>      <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>ny</span><span class=p>,</span> <span class=n>nx</span> <span class=ow>in</span> <span class=n>get_neighbors</span><span class=p>(</span><span class=n>cy</span><span class=p>,</span> <span class=n>cx</span><span class=p>):</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=c1># within bounds?</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span> <span class=o>&lt;=</span> <span class=n>ny</span> <span class=o>&lt;</span> <span class=n>graph</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=ow>and</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span> <span class=o>&lt;=</span> <span class=n>nx</span> <span class=o>&lt;</span> <span class=n>graph</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=ow>and</span>
</span></span><span class=line><span class=cl>        <span class=ow>not</span> <span class=n>visited</span><span class=p>[</span><span class=n>ny</span><span class=p>][</span><span class=n>nx</span><span class=p>]</span> <span class=ow>and</span>
</span></span><span class=line><span class=cl>        <span class=c1># not a wall?</span>
</span></span><span class=line><span class=cl>        <span class=n>graph</span><span class=p>[</span><span class=n>ny</span><span class=p>][</span><span class=n>nx</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>      <span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>candidates</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>ny</span><span class=p>,</span> <span class=n>nx</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>visited</span><span class=p>[</span><span class=n>ny</span><span class=p>][</span><span class=n>nx</span><span class=p>]</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>found</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>dfs</span><span class=p>(</span><span class=n>maze</span><span class=p>,</span> <span class=n>visualize</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></div><figure class="mx-auto my-0 rounded-md"><img src=/posts/graph-search/dfs.gif alt="DFS search" class="mx-auto my-0 rounded-md"></figure><p>DFS search time is proportional to the number of vertices in our adjacency matrix - \(O(N^2)\). The space required to store intermediate states is proportional to the number of vertices (since <code>visited</code> array and <code>candidates</code> stack are the only auxiliary objects in our function), therefore \(O(N^2)\).</p><h2 id=breadth-first-search class="relative group">Breadth-First Search <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#breadth-first-search aria-label=Anchor>#</a></span></h2><p>A natural modification to DFS could be made on candidate selection. In fact, graph search algorithms like A* and Dijkstra are merely intelligent ways of &lsquo;choosing where to search&rsquo;. For BFS, instead of going down the rabbit-hole on a single vertex, what if we first explore all vertices available at a given level?</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>bfs</span><span class=p>(</span><span class=n>graph</span><span class=p>:</span> <span class=n>np</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>start</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=mi>1</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>end</span><span class=p>:</span> <span class=nb>tuple</span><span class=p>[</span><span class=nb>int</span><span class=p>,</span> <span class=nb>int</span><span class=p>]</span> <span class=o>=</span> <span class=p>(</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=o>-</span><span class=mi>2</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>visualize</span><span class=p>:</span> <span class=nb>bool</span> <span class=o>=</span> <span class=kc>False</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>bool</span><span class=p>:</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;&#34;&#34;Checks if a path exists between `start` and `end`.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>  <span class=n>visited</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>graph</span><span class=p>)</span><span class=o>.</span><span class=n>astype</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>bool_</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>candidates</span> <span class=o>=</span> <span class=p>[</span><span class=n>start</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=n>visited</span><span class=p>[</span><span class=n>start</span><span class=p>]</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>found</span> <span class=o>=</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>  <span class=k>while</span> <span class=n>candidates</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>visualize</span><span class=p>:</span> <span class=n>draw</span><span class=p>(</span><span class=n>np</span><span class=o>.</span><span class=n>where</span><span class=p>(</span><span class=n>visited</span><span class=p>,</span> <span class=mf>0.5</span><span class=p>,</span> <span class=n>maze</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Pick candidates in the order they were added, i.e. FIFO.</span>
</span></span><span class=line><span class=cl>    <span class=c1># Observe that this is the *only* change from DFS!</span>
</span></span><span class=line><span class=cl>    <span class=n>cy</span><span class=p>,</span> <span class=n>cx</span> <span class=o>=</span> <span class=n>candidates</span><span class=o>.</span><span class=n>pop</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>visited</span><span class=p>[</span><span class=n>end</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>      <span class=n>found</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>      <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>ny</span><span class=p>,</span> <span class=n>nx</span> <span class=ow>in</span> <span class=n>get_neighbors</span><span class=p>(</span><span class=n>cy</span><span class=p>,</span> <span class=n>cx</span><span class=p>):</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=c1># within bounds?</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span> <span class=o>&lt;=</span> <span class=n>ny</span> <span class=o>&lt;</span> <span class=n>graph</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=ow>and</span>
</span></span><span class=line><span class=cl>        <span class=mi>0</span> <span class=o>&lt;=</span> <span class=n>nx</span> <span class=o>&lt;</span> <span class=n>graph</span><span class=o>.</span><span class=n>shape</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span> <span class=ow>and</span>
</span></span><span class=line><span class=cl>        <span class=ow>not</span> <span class=n>visited</span><span class=p>[</span><span class=n>ny</span><span class=p>][</span><span class=n>nx</span><span class=p>]</span> <span class=ow>and</span>
</span></span><span class=line><span class=cl>        <span class=c1># not a wall?</span>
</span></span><span class=line><span class=cl>        <span class=n>graph</span><span class=p>[</span><span class=n>ny</span><span class=p>][</span><span class=n>nx</span><span class=p>]</span> <span class=o>!=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>      <span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>candidates</span><span class=o>.</span><span class=n>append</span><span class=p>((</span><span class=n>ny</span><span class=p>,</span> <span class=n>nx</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>visited</span><span class=p>[</span><span class=n>ny</span><span class=p>][</span><span class=n>nx</span><span class=p>]</span> <span class=o>=</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>found</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>bfs</span><span class=p>(</span><span class=n>maze</span><span class=p>,</span> <span class=n>visualize</span><span class=o>=</span><span class=kc>True</span><span class=p>)</span>
</span></span></code></pre></div><figure class="mx-auto my-0 rounded-md"><img src=/posts/graph-search/bfs.gif alt class="mx-auto my-0 rounded-md"><figcaption class=text-center>Breadth-First Search</figcaption></figure><p>BFS has the same time and space complexity as DFS in this example - \(O(N^2)\). It also <em>feels</em> parallel. It is because it switches between candidates very quickly - exploring horizontally across each level before exhausting and going to the next level in depth.</p><div class="flex rounded-md bg-primary-100 px-4 py-3 dark:bg-primary-900"><span class="pe-3 text-primary-400"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M256 0C114.6.0.0 114.6.0 256s114.6 256 256 256 256-114.6 256-256S397.4.0 256 0zm0 128c17.67.0 32 14.33 32 32 0 17.67-14.33 32-32 32s-32-14.3-32-32 14.3-32 32-32zm40 256h-80c-13.2.0-24-10.7-24-24s10.75-24 24-24h16v-64h-8c-13.25.0-24-10.75-24-24s10.8-24 24-24h32c13.25.0 24 10.75 24 24v88h16c13.25.0 24 10.75 24 24s-10.7 24-24 24z"/></svg>
</span></span><span class=dark:text-neutral-300>We can do a microbenchmark to see that neither of DFS or BFS is relatively faster. This is expected for large, uniformly random mazes. Real world graphs typically carry structure bias towards depth (or width). Hence, your choice of DFS/BFS should be informed by the structure of the graph.</span></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># takes ~1 min</span>
</span></span><span class=line><span class=cl><span class=o>%</span><span class=n>timeit</span> <span class=o>-</span><span class=n>n</span> <span class=mi>5</span> <span class=o>-</span><span class=n>r</span> <span class=mi>10</span> <span class=n>dfs</span><span class=p>(</span><span class=n>generate_maze</span><span class=p>(</span><span class=mi>500</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=o>%</span><span class=n>timeit</span> <span class=o>-</span><span class=n>n</span> <span class=mi>5</span> <span class=o>-</span><span class=n>r</span> <span class=mi>10</span> <span class=n>bfs</span><span class=p>(</span><span class=n>generate_maze</span><span class=p>(</span><span class=mi>500</span><span class=p>))</span>
</span></span></code></pre></div><pre><code>749 ms ± 58.2 ms per loop (mean ± std. dev. of 10 runs, 5 loops each)
778 ms ± 58.8 ms per loop (mean ± std. dev. of 10 runs, 5 loops each)
</code></pre><h2 id=topological-sort class="relative group">Topological Sort <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#topological-sort aria-label=Anchor>#</a></span></h2><p>Now to the intended goalpost - topological sort. It helps to understand why we need it in the first place. Neural networks are directed acyclic graphs that take a set of input tensor(s), and through multiple operations, return a set of output tensor(s), on which we compute <code>loss</code>, a proxy for how well the network is behaving.</p><p>The training objective of neural networks is to minimize this <code>loss</code> by moving along a direction (a.k.a derivative) and [back]propagating this feedback from the <code>loss</code> node to the inputs. Each node in a neural network &lsquo;knows&rsquo; how to compute its own derivative only when a gradient signal from the nodes succeeding it is available.</p><p>But in a graph with (easily) hundreds of nodes and edges, the autograd engine cannot do a big bang calculation of everything. It must know the exact order of reverse traversal - both for correctness and efficiency of compute.</p><p>We will emulate a neural network by generating a web of nodes that are randomly connected to each other between layers. We control this randomness (ten-dollar word is <em>sparsity</em>) using a parameter. Note that if sparsity is too high (say above <code>0.5</code>), you may end up with unconnected layers. It won&rsquo;t impact our intent though. I even recommend you experiment with different values to understand how <code>toposort</code> identifies viable orderings.</p><p>Bear with me on this boilerplate code to visualize our graph, before we implement <code>toposort(...)</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>itertools</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>networkx</span> <span class=k>as</span> <span class=nn>nx</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>generate_mlp</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=n>layers</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=nb>int</span><span class=p>],</span> 
</span></span><span class=line><span class=cl>  <span class=n>sparsity</span><span class=p>:</span> <span class=nb>float</span> <span class=o>=</span> <span class=mf>0.</span><span class=p>,</span> 
</span></span><span class=line><span class=cl>  <span class=n>seed</span><span class=p>:</span> <span class=nb>int</span> <span class=o>=</span> <span class=mi>42</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=o>-&gt;</span> <span class=nb>tuple</span><span class=p>[</span><span class=n>nx</span><span class=o>.</span><span class=n>DiGraph</span><span class=p>,</span> <span class=nb>dict</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;&#34;&#34;Generate a layer-wise sparsely connected MLP.
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>  Args:
</span></span></span><span class=line><span class=cl><span class=s2>    layers: A list of integers denoting nodes in each layer. First and 
</span></span></span><span class=line><span class=cl><span class=s2>      last are considered input and output nodes respectively.
</span></span></span><span class=line><span class=cl><span class=s2>    sparsity: A float between [0, 1] representing how sparse the graph
</span></span></span><span class=line><span class=cl><span class=s2>      should be. 0 means no sparsity, i.e. a fully-connected MLP.
</span></span></span><span class=line><span class=cl><span class=s2>    seed: For reproducibility.
</span></span></span><span class=line><span class=cl><span class=s2>  
</span></span></span><span class=line><span class=cl><span class=s2>  Returns:
</span></span></span><span class=line><span class=cl><span class=s2>    A tuple of nx.DiGraph and options to plot it pretty.
</span></span></span><span class=line><span class=cl><span class=s2>  &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>  <span class=n>random</span><span class=o>.</span><span class=n>seed</span><span class=p>(</span><span class=n>seed</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>num_layers</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>layers</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1># Assign labels to each node.</span>
</span></span><span class=line><span class=cl>  <span class=n>input_nodes</span> <span class=o>=</span> <span class=p>[</span><span class=sa>f</span><span class=s2>&#34;$x_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>$&#34;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>layers</span><span class=p>[</span><span class=mi>0</span><span class=p>])]</span>
</span></span><span class=line><span class=cl>  <span class=n>hidden_layers</span> <span class=o>=</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=p>[</span><span class=sa>f</span><span class=s2>&#34;$h^</span><span class=si>{</span><span class=n>lyr</span><span class=si>}</span><span class=s2>_</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>$&#34;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>layers</span><span class=p>[</span><span class=n>lyr</span><span class=p>])]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>lyr</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>num_layers</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=n>output_nodes</span> <span class=o>=</span> <span class=p>[</span><span class=sa>f</span><span class=s2>&#34;y</span><span class=si>{</span><span class=n>i</span><span class=si>}</span><span class=s2>&#34;</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>layers</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>])]</span>
</span></span><span class=line><span class=cl>  <span class=n>layers</span> <span class=o>=</span> <span class=p>[</span><span class=n>input_nodes</span><span class=p>,</span> <span class=o>*</span><span class=n>hidden_layers</span><span class=p>,</span> <span class=n>output_nodes</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1># Assign nodes.</span>
</span></span><span class=line><span class=cl>  <span class=n>G</span> <span class=o>=</span> <span class=n>nx</span><span class=o>.</span><span class=n>DiGraph</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=n>lyr</span><span class=p>,</span> <span class=n>nodes</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>layers</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>G</span><span class=o>.</span><span class=n>add_nodes_from</span><span class=p>(</span><span class=n>nodes</span><span class=p>,</span> <span class=n>layer</span><span class=o>=</span><span class=n>lyr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># Assign random edges.</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=n>left_layer</span><span class=p>,</span> <span class=n>right_layer</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>layers</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>],</span> <span class=n>layers</span><span class=p>[</span><span class=mi>1</span><span class=p>:]):</span>
</span></span><span class=line><span class=cl>    <span class=n>connections</span> <span class=o>=</span> <span class=nb>list</span><span class=p>(</span><span class=n>itertools</span><span class=o>.</span><span class=n>product</span><span class=p>(</span><span class=n>left_layer</span><span class=p>,</span> <span class=n>right_layer</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>keep_p</span> <span class=o>=</span> <span class=mi>1</span> <span class=o>-</span> <span class=n>sparsity</span>
</span></span><span class=line><span class=cl>    <span class=n>G</span><span class=o>.</span><span class=n>add_edges_from</span><span class=p>(</span><span class=n>connections</span><span class=p>[:</span><span class=nb>int</span><span class=p>(</span><span class=n>keep_p</span> <span class=o>*</span> <span class=nb>len</span><span class=p>(</span><span class=n>connections</span><span class=p>))])</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># Pretty plot.</span>
</span></span><span class=line><span class=cl>  <span class=n>pos</span> <span class=o>=</span> <span class=n>nx</span><span class=o>.</span><span class=n>multipartite_layout</span><span class=p>(</span><span class=n>G</span><span class=p>,</span> <span class=n>subset_key</span><span class=o>=</span><span class=s2>&#34;layer&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>colors</span> <span class=o>=</span> <span class=p>[</span><span class=s2>&#34;gold&#34;</span><span class=p>]</span> <span class=o>+</span> <span class=p>[</span><span class=s2>&#34;violet&#34;</span><span class=p>]</span> <span class=o>*</span> <span class=p>(</span><span class=n>num_layers</span> <span class=o>-</span> <span class=mi>2</span><span class=p>)</span> <span class=o>+</span> <span class=p>[</span><span class=s2>&#34;limegreen&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>  <span class=n>options</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;node_color&#34;</span><span class=p>:</span> <span class=p>[</span><span class=n>colors</span><span class=p>[</span><span class=n>data</span><span class=p>[</span><span class=s2>&#34;layer&#34;</span><span class=p>]]</span> <span class=k>for</span> <span class=n>node</span><span class=p>,</span> <span class=n>data</span> <span class=ow>in</span> <span class=n>G</span><span class=o>.</span><span class=n>nodes</span><span class=p>(</span><span class=n>data</span><span class=o>=</span><span class=kc>True</span><span class=p>)],</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;with_labels&#34;</span><span class=p>:</span> <span class=kc>True</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;node_size&#34;</span><span class=p>:</span> <span class=mi>1000</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;pos&#34;</span><span class=p>:</span> <span class=n>pos</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>G</span><span class=p>,</span> <span class=n>options</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>G</span><span class=p>,</span> <span class=n>options</span> <span class=o>=</span> <span class=n>generate_mlp</span><span class=p>([</span><span class=mi>3</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>6</span><span class=p>,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>sparsity</span><span class=o>=</span><span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>nx</span><span class=o>.</span><span class=n>draw</span><span class=p>(</span><span class=n>G</span><span class=p>,</span> <span class=o>**</span><span class=n>options</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></div><figure class="mx-auto my-0 rounded-md"><img src=/posts/graph-search/sparse_mlp.png alt="Sparse MLP graph" class="mx-auto my-0 rounded-md"></figure><p>The only important observation is that not all nodes may influence the terminal <code>loss</code> node (indexed as \(y_i\)) in this example. Our sorting algorithm should identify this.</p><p>In other words, for a root node <code>loss</code>, the autograd engine needs a list of all dependencies to <code>loss</code> all the way to input tensor(s), in the <em>order</em> they impact it. This is like searching along the depth from the <code>loss</code> node (did it click in your mind?). We will use <code>toposort</code> to find these orderings from a given root node to the stopping points on the graph (i.e. nodes with no more ancestors) via depth-first search.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>toposort</span><span class=p>(</span><span class=n>G</span><span class=p>:</span> <span class=n>nx</span><span class=o>.</span><span class=n>DiGraph</span><span class=p>,</span> <span class=n>root</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;&#34;&#34;Returns a topological ordering from `root` on the graph `G`.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>  <span class=n>visited</span> <span class=o>=</span> <span class=nb>set</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=n>order</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>_dfs</span><span class=p>(</span><span class=n>node</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>node</span> <span class=ow>not</span> <span class=ow>in</span> <span class=n>visited</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=n>visited</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=c1># If the node has ancestors, DFS along each.</span>
</span></span><span class=line><span class=cl>      <span class=k>for</span> <span class=n>parent</span> <span class=ow>in</span> <span class=n>G</span><span class=o>.</span><span class=n>predecessors</span><span class=p>(</span><span class=n>node</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>_dfs</span><span class=p>(</span><span class=n>parent</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl>      <span class=c1># Once all ancestors have been evaluated,</span>
</span></span><span class=line><span class=cl>      <span class=c1># add the node to the topological order.</span>
</span></span><span class=line><span class=cl>      <span class=n>order</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># Start searching for stopping points from the root.</span>
</span></span><span class=line><span class=cl>  <span class=n>_dfs</span><span class=p>(</span><span class=n>root</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1># Because we start from the root node.</span>
</span></span><span class=line><span class=cl>  <span class=n>order</span><span class=o>.</span><span class=n>reverse</span><span class=p>()</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>order</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>order</span> <span class=o>=</span> <span class=n>toposort</span><span class=p>(</span><span class=n>G</span><span class=p>,</span> <span class=s1>&#39;y0&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>order</span>
</span></span></code></pre></div><pre><code>['y0',
 '$h^4_2$',
 '$h^4_1$',
 '$h^4_0$',
 '$h^3_1$',
 '$h^3_0$',
 '$h^2_2$',
 '$h^2_1$',
 '$h^2_0$',
 '$h^1_1$',
 '$h^1_0$',
 '$x_1$',
 '$x_0$']
</code></pre><p>Modulo the ugly \(\LaTeX\) formatting, We can see that <code>toposort</code> returns an ordering from output node(s) to input node(s) whenever there is a path connecting them.</p><p>Let&rsquo;s draw these backward edges.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>draw_backward_traversal</span><span class=p>(</span><span class=n>G</span><span class=p>:</span> <span class=n>nx</span><span class=o>.</span><span class=n>DiGraph</span><span class=p>,</span> <span class=n>order</span><span class=p>:</span> <span class=nb>list</span><span class=p>[</span><span class=nb>str</span><span class=p>]):</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;&#34;&#34;Plots the reverse traversal of nodes given in `order` on the graph `G`.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>  <span class=n>edges</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=n>node</span> <span class=ow>in</span> <span class=n>order</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># Point incident edges backwards</span>
</span></span><span class=line><span class=cl>    <span class=n>incident_edges</span> <span class=o>=</span> <span class=n>G</span><span class=o>.</span><span class=n>in_edges</span><span class=p>(</span><span class=n>node</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>incident_edges</span> <span class=o>=</span> <span class=p>[</span><span class=n>e</span><span class=p>[::</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=k>for</span> <span class=n>e</span> <span class=ow>in</span> <span class=n>incident_edges</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>edges</span><span class=o>.</span><span class=n>extend</span><span class=p>(</span><span class=n>incident_edges</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=n>nx</span><span class=o>.</span><span class=n>draw</span><span class=p>(</span><span class=n>G</span><span class=p>,</span> <span class=n>edgelist</span><span class=o>=</span><span class=n>edges</span><span class=p>,</span> <span class=n>edge_color</span><span class=o>=</span><span class=s2>&#34;red&#34;</span><span class=p>,</span> <span class=o>**</span><span class=n>options</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>draw_backward_traversal</span><span class=p>(</span><span class=n>G</span><span class=p>,</span> <span class=n>order</span><span class=p>)</span>
</span></span></code></pre></div><figure class="mx-auto my-0 rounded-md"><img src=/posts/graph-search/mlp_backward.png alt="MLP backward traversal" class="mx-auto my-0 rounded-md"></figure><p>See? The topological ordering automatically ignores nodes (even inputs) that do not influence the output.</p><div class="flex rounded-md bg-primary-100 px-4 py-3 dark:bg-primary-900"><span class="pe-3 text-primary-400"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M256 0C114.6.0.0 114.6.0 256s114.6 256 256 256 256-114.6 256-256S397.4.0 256 0zm0 128c17.67.0 32 14.33 32 32 0 17.67-14.33 32-32 32s-32-14.3-32-32 14.3-32 32-32zm40 256h-80c-13.2.0-24-10.7-24-24s10.75-24 24-24h16v-64h-8c-13.25.0-24-10.75-24-24s10.8-24 24-24h32c13.25.0 24 10.75 24 24v88h16c13.25.0 24 10.75 24 24s-10.7 24-24 24z"/></svg>
</span></span><span class=dark:text-neutral-300>This is an unconventional example of &lsquo;sparsely-connected&rsquo; MLPs. In practice, MLPs are trained fully-connected. Some may find it easier to imagine these graph nodes are arbitrary functions themselves, instead of MLPs.</span></div><h2 id=we-knew-it-all-along-didnt-we class="relative group">We knew it all along, didn&rsquo;t we? <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#we-knew-it-all-along-didnt-we aria-label=Anchor>#</a></span></h2><p>This exercise taught me that algorithms of this class are actually straightforward to understand if you have a view of the entire graph and you know the objective. The challenge lies in expressing your computation in a way computers can understand. Specifically:</p><ul><li>How can you identify a sub-problem that can be recursed/iterated over.</li><li>How and when to recurse/iterate over that subproblem, and</li><li>How to book-keep states efficiently.</li></ul><p>We take for granted how much our brain does this in a diffused manner. Luckily, with frontier language models getting better, &rsquo;talking&rsquo; with computers will get easier.</p><p>I hoped to cover Dijkstra and A* as well, given how they add a sprinkle of intelligence (read heuristics) to solve certain classes of graph problems faster. That will be a different article for now.</p></div></section><footer class="max-w-prose pt-8 print:hidden"><div class=flex><picture class="!mb-0 !mt-0 me-4 w-24 h-auto rounded-full"><img width=646 height=640 class="!mb-0 !mt-0 me-4 w-24 h-auto rounded-full" alt="Karan Shah" loading=lazy decoding=async src=/img/profile.png></picture><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Karan Shah</div><div class="text-sm text-neutral-700 dark:text-neutral-400">Sampling meaning from a non-stationary prior.</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=https://masterskepticista.github.io/ target=_blank aria-label=Link rel="me noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 640 512"><path fill="currentcolor" d="M172.5 131.1c55.6-55.59 148-55.59 203.6.0 50 50 57.4 129.7 16.3 187.2L391.3 319.9C381 334.2 361 337.6 346.7 327.3c-14.4-10.3-17.8-30.3-7.5-44.6L340.3 281.1C363.2 249 359.6 205.1 331.7 177.2c-31.4-31.4-82.5-31.4-114 0L105.5 289.5c-31.51 30.6-31.51 82.5.0 114C133.3 431.4 177.3 435 209.3 412.1L210.9 410.1C225.3 400.7 245.3 404 255.5 418.4 265.8 432.8 262.5 452.8 248.1 463.1L246.5 464.2c-58.4 41.1-136.3 34.5-186.29-15.4-56.469-56.5-56.469-148.1.0-204.5L172.5 131.1zM467.5 380c-56.5 56.5-148 56.5-204.5.0-50-50-56.5-128.8-15.4-186.3L248.7 192.1C258.1 177.8 278.1 174.4 293.3 184.7 307.7 194.1 311.1 214.1 300.8 229.3L299.7 230.9C276.8 262.1 280.4 306.9 308.3 334.8c31.4 31.4 82.5 31.4 114 0L534.5 222.5c31.5-31.5 31.5-83.4.0-114C506.7 80.63 462.7 76.99 430.7 99.9L429.1 101C414.7 111.3 394.7 107.1 384.5 93.58 374.2 79.2 377.5 59.21 391.9 48.94L393.5 47.82C451 6.731 529.8 13.25 579.8 63.24c56.5 56.46 56.5 148.06.0 204.46L467.5 380z"/></svg>
</span></a><a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=https://github.com/MasterSkepticista target=_blank aria-label=Github rel="me noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
</span></a><a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href="https://scholar.google.com/citations?user=vEgcRTkAAAAJ&amp;hl=en" target=_blank aria-label=Google-Scholar rel="me noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg height="16" width="16" viewBox="0 0 512 512"><path fill="currentcolor" d="M390.9 298.5s0 .1.1.1c9.2 19.4 14.4 41.1 14.4 64C405.3 445.1 338.5 512 256 512s-149.3-66.9-149.3-149.3c0-22.9 5.2-44.6 14.4-64h0c1.7-3.6 3.6-7.2 5.6-10.7 4.4-7.6 9.4-14.7 15-21.3 27.4-32.6 68.5-53.3 114.4-53.3 33.6.0 64.6 11.1 89.6 29.9 9.1 6.9 17.4 14.7 24.8 23.5 5.6 6.6 10.6 13.8 15 21.3 2 3.4 3.8 7 5.5 10.5zm26.4-18.8c-30.1-58.4-91-98.4-161.3-98.4s-131.2 40-161.3 98.4L0 202.7 256 0 512 202.7l-94.7 77.1z"/></svg></span></a>
<a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=https://linkedin.com/in/karan-bhavesh-shah target=_blank aria-label=Linkedin rel="me noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg>
</span></a><a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=https://stackoverflow.com/users/9230398/karan-shah target=_blank aria-label=Stack-Overflow rel="me noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 384 512"><path fill="currentcolor" d="M290.7 311 95 269.7 86.8 309l195.7 41zm51-87L188.2 95.7l-25.5 30.8 153.5 128.3zm-31.2 39.7L129.2 179l-16.7 36.5L293.7 3e2zM262 32l-32 24 119.3 160.3 32-24zm20.5 328h-2e2v39.7h2e2zm39.7 80H42.7V320h-40v160h359.5V320h-40z"/></svg>
</span></a><a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" style=will-change:transform href=https://twitter.com/elevated_quark target=_blank aria-label=X-Twitter rel="me noopener noreferrer"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"/></svg></span></a></div></div></div></div><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="group flex" href=/posts/detr/><span class="me-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"><span class="ltr:inline rtl:hidden">&larr;</span><span class="ltr:hidden rtl:inline">&rarr;</span></span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">PyTorch: I’m Fast, JAX: You Call That Fast?</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2024-08-16 00:00:00 +0000 UTC">16 August 2024</time>
</span></span></a></span><span><a class="group flex text-right" href=/posts/dimensionality/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">The Blessing of Dimensionality</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2024-11-11 00:00:00 +0000 UTC">11 November 2024</time>
</span></span><span class="ms-2 text-neutral-700 transition-transform group-hover:-translate-x-[-2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"><span class="ltr:inline rtl:hidden">&rarr;</span><span class="ltr:hidden rtl:inline">&larr;</span></span></a></span></div></div></footer></article></main><div class="pointer-events-none absolute bottom-0 end-0 top-[100vh] w-12" id=to-top hidden=true><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div><footer class="py-10 print:hidden"><div class="flex items-center justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">Copyright © 2025 Karan Shah. If you copy this, may your WiFi become unstable.</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://github.com/jpanther/congo target=_blank rel="noopener noreferrer">Congo</a></p></div><div class="flex flex-row items-center"></div></div></footer><div id=search-wrapper class="invisible fixed inset-0 z-50 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://masterskepticista.github.io/><div id=search-modal class="top-20 mx-auto flex min-h-0 w-full max-w-3xl flex-col rounded-md border border-neutral-200 bg-neutral shadow-lg dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex flex-none items-center justify-between px-2"><form class="flex min-w-0 flex-auto items-center"><div class="flex h-8 w-8 items-center justify-center text-neutral-400"><span class="icon relative inline-block px-1 align-text-bottom"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="mx-1 flex h-12 flex-auto appearance-none bg-transparent focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex h-8 w-8 items-center justify-center text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto overflow-auto px-2"><ul id=search-results></ul></section></div></div></div></body></html>