<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=light data-auto-appearance=true><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="#FFFFFF"><title>The Blessing of Dimensionality &#183; MasterSkepticista</title>
<meta name=title content="The Blessing of Dimensionality &#183; MasterSkepticista"><script type=text/javascript src=/js/appearance.min.8a082f81b27f3cb2ee528df0b0bdc39787034cf2cc34d4669fbc9977c929023c.js integrity="sha256-iggvgbJ/PLLuUo3wsL3Dl4cDTPLMNNRmn7yZd8kpAjw="></script><link type=text/css rel=stylesheet href=/css/main.bundle.min.eaf5efab3f4188a116dda7ffc5498d61662733eaf22fa6a2fcb554efa84c23c8.css integrity="sha256-6vXvqz9BiKEW3af/xUmNYWYnM+ryL6ai/LVU76hMI8g="><script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.bb487ad6073790cb02c354ee8c5f8822c42c5513e10bf7a86bbe8f82118cd1fc.js integrity="sha256-u0h61gc3kMsCw1TujF+IIsQsVRPhC/eoa76PghGM0fw=" data-copy=Copy data-copied=Copied></script><meta name=description content="
      
        &rsquo;nuff said about the curse of dimensionality
      
    "><link rel=canonical href=https://masterskepticista.github.io/posts/dimensionality/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:url" content="https://masterskepticista.github.io/posts/dimensionality/"><meta property="og:site_name" content="MasterSkepticista"><meta property="og:title" content="The Blessing of Dimensionality"><meta property="og:description" content="’nuff said about the curse of dimensionality"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-11-11T00:00:00+00:00"><meta property="article:modified_time" content="2024-11-11T00:00:00+00:00"><meta property="article:tag" content="Dimensionality"><meta property="article:tag" content="Geometry"><meta property="article:tag" content="Neural Networks"><meta name=twitter:card content="summary"><meta name=twitter:title content="The Blessing of Dimensionality"><meta name=twitter:description content="’nuff said about the curse of dimensionality"><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"The Blessing of Dimensionality","headline":"The Blessing of Dimensionality","abstract":"\u0026rsquo;nuff said about the curse of dimensionality","inLanguage":"en","url":"https:\/\/masterskepticista.github.io\/posts\/dimensionality\/","author":{"@type":"Person","name":"Karan Shah"},"copyrightYear":"2024","dateCreated":"2024-11-11T00:00:00\u002b00:00","datePublished":"2024-11-11T00:00:00\u002b00:00","dateModified":"2024-11-11T00:00:00\u002b00:00","keywords":["dimensionality","geometry","neural networks"],"mainEntityOfPage":"true","wordCount":"1005"}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://masterskepticista.github.io/","name":"","position":1},{"@type":"ListItem","item":"https://masterskepticista.github.io/posts/","name":"Posts","position":2},{"@type":"ListItem","name":"The Blessing of Dimensionality","position":3}]}</script><meta name=author content="Karan Shah"><link href=https://masterskepticista.github.io/ rel=me><link href=https://github.com/MasterSkepticista rel=me><link href="https://scholar.google.com/citations?user=vEgcRTkAAAAJ&amp;hl=en" rel=me><link href=https://linkedin.com/in/karan-bhavesh-shah rel=me><link href=https://stackoverflow.com/users/9230398/karan-shah rel=me><link href=https://twitter.com/elevated_quark rel=me><link type=text/css rel=stylesheet href=/lib/katex/katex.min.68e17230ccd917b97b7a2def38a8108918599d8aa4f580bfb8cce5e13d23e4de43dcaba5f9000553cb2c10d0d1300aabfe5c433a3305ebd752609f0762a63e59.css integrity="sha512-aOFyMMzZF7l7ei3vOKgQiRhZnYqk9YC/uMzl4T0j5N5D3Kul+QAFU8ssENDRMAqr/lxDOjMF69dSYJ8HYqY+WQ=="><script defer src=/lib/katex/katex.min.50f14e69d6a8da7128ae3b63974c544ed377c36d096b5e3750f114e84c89d668b9301d9b0ed3248969aa183aa2e3bc4d2c1e73d5dcb7d462890c45a18d424589.js integrity="sha512-UPFOadao2nEorjtjl0xUTtN3w20Ja143UPEU6EyJ1mi5MB2bDtMkiWmqGDqi47xNLB5z1dy31GKJDEWhjUJFiQ=="></script><script defer src=/lib/katex/auto-render.min.6095714e3aadb63b14ddc4af69346ab12974c1b460654345f8d1860a0b68fcc51b22f68b757433193090bb80afc8965b65cb607e5541d0f5f0f4b2e64d69b9ff.js integrity="sha512-YJVxTjqttjsU3cSvaTRqsSl0wbRgZUNF+NGGCgto/MUbIvaLdXQzGTCQu4CvyJZbZctgflVB0PXw9LLmTWm5/w==" onload=renderMathInElement(document.body)></script></head><body class="m-auto flex h-screen max-w-7xl flex-col bg-neutral px-6 text-lg leading-7 text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"><div id=the-top class="absolute flex self-center"><a class="-translate-y-8 rounded-b-lg bg-primary-200 px-3 py-1 text-sm focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="pe-2 font-bold text-primary-600 dark:text-primary-400">&darr;</span>Skip to main content</a></div><header class="py-6 font-semibold text-neutral-900 dark:text-neutral sm:py-10 print:hidden"><nav class="flex items-start justify-between sm:items-center"><div class="z-40 flex flex-row items-center"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" rel=me href=/>MasterSkepticista</a></div><label id=menu-button for=menu-controller class="block sm:hidden"><input type=checkbox id=menu-controller class=hidden><div class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 448 512"><path fill="currentcolor" d="M0 96C0 78.33 14.33 64 32 64H416c17.7.0 32 14.33 32 32 0 17.7-14.3 32-32 32H32C14.33 128 0 113.7.0 96zM0 256c0-17.7 14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32H32c-17.67.0-32-14.3-32-32zM416 448H32c-17.67.0-32-14.3-32-32s14.33-32 32-32H416c17.7.0 32 14.3 32 32s-14.3 32-32 32z"/></svg></span></div><div id=menu-wrapper class="invisible fixed inset-0 z-30 m-auto h-full w-full cursor-default overflow-auto bg-neutral-100/50 opacity-0 backdrop-blur-sm transition-opacity dark:bg-neutral-900/50"><ul class="mx-auto flex w-full max-w-7xl list-none flex-col overflow-visible px-6 py-6 text-end sm:px-14 sm:py-10 sm:pt-10 md:px-24 lg:px-32"><li class=mb-1><span class="cursor-pointer hover:text-primary-600 dark:hover:text-primary-400"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></span></li><li class="group mb-1"><a href=/posts/ title onclick=close_menu()><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Blog</span></a></li><li class="group mb-1"><a href=/code/ title onclick=close_menu()><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Code</span></a></li><li class="group mb-1"><a href=/talks/ title onclick=close_menu()><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Talks</span></a></li><li class="group mb-1"><button id=search-button-1 title="Search (/)">
<span class="group-dark:hover:text-primary-400 transition-colors group-hover:text-primary-600"><span class="icon relative inline-block px-1 align-text-bottom"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span></button></li></ul></div></label><ul class="hidden list-none flex-row text-end sm:flex"><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0"><a href=/posts/ title><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Blog</span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0"><a href=/code/ title><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Code</span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0"><a href=/talks/ title><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Talks</span></a></li><li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0"><button id=search-button-2 title="Search (/)">
<span class="group-dark:hover:text-primary-400 transition-colors group-hover:text-primary-600"><span class="icon relative inline-block px-1 align-text-bottom"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg>
</span></span><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"></span></button></li></ul></nav></header><div class="relative flex grow flex-col"><main id=main-content class=grow><article><header class=max-w-prose><ol class="text-sm text-neutral-500 dark:text-neutral-400 print:hidden"><li class="hidden inline"><a class="dark:underline-neutral-600 decoration-neutral-300 hover:underline" href=/></a><span class="px-1 text-primary-500">/</span></li><li class=inline><a class="dark:underline-neutral-600 decoration-neutral-300 hover:underline" href=/posts/>Posts</a><span class="px-1 text-primary-500">/</span></li><li class="hidden inline"><a class="dark:underline-neutral-600 decoration-neutral-300 hover:underline" href=/posts/dimensionality/>The Blessing of Dimensionality</a><span class="px-1 text-primary-500">/</span></li></ol><h1 class="mb-8 mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">The Blessing of Dimensionality</h1><div class="mb-10 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2024-11-11 00:00:00 +0000 UTC">11 November 2024</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">5 mins</span></div></div></header><section class="prose mt-0 flex max-w-full flex-col dark:prose-invert lg:flex-row"><div class="order-first px-0 lg:order-last lg:max-w-xs lg:ps-8"><div class="toc pe-5 lg:sticky lg:top-10 print:hidden"><details open class="-ms-5 mt-0 overflow-hidden rounded-lg ps-5"><summary class="block cursor-pointer bg-neutral-100 py-1 ps-5 text-lg font-semibold text-neutral-800 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="border-s border-dotted border-neutral-300 py-2 ps-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#data-as-a-manifold>Data as a Manifold</a></li><li><a href=#a-number-line>A Number Line</a><ul><li><a href=#classification-in-1d>Classification in 1D</a></li><li><a href=#adding-a-virtual-dimension>Adding a virtual dimension</a></li></ul></li><li><a href=#concentric-circles>Concentric Circles</a><ul><li><a href=#classification-in-2d>Classification in 2D</a></li><li><a href=#adding-a-virtual-dimension-1>Adding a virtual dimension</a></li></ul></li></ul></nav></div></details></div></div><div class="min-h-0 min-w-0 max-w-prose grow"><p>Grant recently published a <a href="https://www.youtube.com/watch?v=piJkuavhV50" target=_blank rel=noreferrer>video</a> on how certain geometry puzzles become trivial to solve, when one additional dimension is available for the kind of geometry at hand. Math provides the necessary abstraction to think (and compute) in a dimensionality that far exceeds human imagination of 3 dimensions.</p><p>Modern foundation models use more than 10,000 feature vector dimensions. As of writing, few tools exist to understand what exactly happens in each of these dimensions. The goal of this post is not to explain what additional dimensions do, but to reason about how dimensionality affects learning, and <em>why</em> more dimensions typically yield better models. If you have read Chris Olah&rsquo;s decade-old post on <a href=https://colah.github.io/posts/2014-03-NN-Manifolds-Topology/ target=_blank rel=noreferrer>manifold hypothesis</a>, first half of this post should be a cakewalk.</p><h2 id=data-as-a-manifold class="relative group">Data as a Manifold <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#data-as-a-manifold aria-label=Anchor>#</a></span></h2><p>Classification is a common deep learning task. Even foundation LLMs are trained on next-token prediction, which is a classification task. We can view classification as a way of transforming the data manifold into representations that can be sliced into individual classes.</p><blockquote><p>The manifold hypothesis is that natural data forms <strong>lower-dimensional manifolds</strong> in its embedding space. [&mldr;] If you believe this, then <strong>the task of a classification algorithm is fundamentally to separate a bunch of tangled manifolds.</strong></p></blockquote><p>Neural networks (NNs) are efficient at extracting representations from data by augmenting it into certain size of representations. Dimensionality of the representations that NNs extract from natural data depends on what is expected of them. For example, sentiment classification models may require a smaller data manifold, than say, summarizing it, if both models are trained from scratch until convergence.</p><h2 id=a-number-line class="relative group">A Number Line <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#a-number-line aria-label=Anchor>#</a></span></h2><p>What better place to start an article like this with 1D space? Consider a simple binary classification problem. We have two classes, <code>0</code> and <code>1</code>, represented by three blobs on a number line. The inner blue blob is class <code>1</code>, and the outer red blobs are class <code>0</code>.</p><figure class="mx-auto my-0 rounded-md"><img src=/posts/dimensionality/scatter1d.png alt="1D Scatter" class="mx-auto my-0 rounded-md"><figcaption class=text-center>1D Scatter</figcaption></figure><p>We know via the <a href=https://en.wikipedia.org/wiki/Universal_approximation_theorem target=_blank rel=noreferrer>universal approximation theorem</a>, that a neural network with at least one hidden layer (of arbitrary dimensionality) can approximate <strong>any</strong> function.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>Brain</span><span class=p>(</span><span class=n>nn</span><span class=o>.</span><span class=n>Module</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;&#34;&#34;Brain with a single hidden layer.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>  <span class=n>dimensions</span><span class=p>:</span> <span class=nb>int</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=nd>@nn.compact</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=fm>__call__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>inputs</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>out</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Dense</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>dimensions</span><span class=p>,</span> <span class=n>kernel_init</span><span class=o>=</span><span class=n>nn</span><span class=o>.</span><span class=n>initializers</span><span class=o>.</span><span class=n>xavier_uniform</span><span class=p>())(</span><span class=n>inputs</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>out</span><span class=p>[</span><span class=s2>&#34;activation&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>tanh</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>nn</span><span class=o>.</span><span class=n>Dense</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>name</span><span class=o>=</span><span class=s2>&#34;classifier&#34;</span><span class=p>)(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>x</span><span class=p>,</span> <span class=n>out</span>
</span></span></code></pre></div><p>On a number line, the only way to classify these two classes is to find a threshold value. This threshold value is the decision boundary.</p><p>We need some boilerplate to train this model. This is a vanilla SGD-based training loop with no fancy regularization or momentum.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>fit</span><span class=p>(</span><span class=n>brain</span><span class=p>:</span> <span class=n>nn</span><span class=o>.</span><span class=n>Module</span><span class=p>,</span> <span class=n>params</span><span class=p>,</span> <span class=n>x</span><span class=p>:</span> <span class=n>jnp</span><span class=o>.</span><span class=n>ndarray</span><span class=p>,</span> <span class=n>y</span><span class=p>:</span> <span class=n>jnp</span><span class=o>.</span><span class=n>ndarray</span><span class=p>):</span>
</span></span><span class=line><span class=cl>  <span class=s2>&#34;&#34;&#34;Fit a classification model to the given data.&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=nd>@jax.jit</span>
</span></span><span class=line><span class=cl>  <span class=k>def</span> <span class=nf>train_step</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>opt_state</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>loss_fn</span><span class=p>(</span><span class=n>params</span><span class=p>):</span>
</span></span><span class=line><span class=cl>      <span class=n>logits</span><span class=p>,</span> <span class=n>out</span> <span class=o>=</span> <span class=n>brain</span><span class=o>.</span><span class=n>apply</span><span class=p>({</span><span class=s2>&#34;params&#34;</span><span class=p>:</span> <span class=n>params</span><span class=p>},</span> <span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>logits</span> <span class=o>=</span> <span class=n>jnp</span><span class=o>.</span><span class=n>squeeze</span><span class=p>(</span><span class=n>logits</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>loss</span> <span class=o>=</span> <span class=n>optax</span><span class=o>.</span><span class=n>sigmoid_binary_cross_entropy</span><span class=p>(</span><span class=n>logits</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span><span class=o>.</span><span class=n>mean</span><span class=p>()</span>
</span></span><span class=line><span class=cl>      <span class=n>acc</span> <span class=o>=</span> <span class=n>jnp</span><span class=o>.</span><span class=n>mean</span><span class=p>((</span><span class=n>logits</span> <span class=o>&gt;</span> <span class=mf>0.5</span><span class=p>)</span> <span class=o>==</span> <span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>      <span class=n>metrics</span> <span class=o>=</span> <span class=p>{</span><span class=s2>&#34;loss&#34;</span><span class=p>:</span> <span class=n>loss</span><span class=p>,</span> <span class=s2>&#34;acc&#34;</span><span class=p>:</span> <span class=n>acc</span><span class=p>}</span>
</span></span><span class=line><span class=cl>      <span class=k>return</span> <span class=n>loss</span><span class=p>,</span> <span class=p>(</span><span class=n>metrics</span><span class=p>,</span> <span class=n>out</span><span class=p>[</span><span class=s2>&#34;activation&#34;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=p>(</span><span class=n>_</span><span class=p>,</span> <span class=p>(</span><span class=n>metrics</span><span class=p>,</span> <span class=n>acts</span><span class=p>)),</span> <span class=n>grads</span> <span class=o>=</span> <span class=n>jax</span><span class=o>.</span><span class=n>value_and_grad</span><span class=p>(</span><span class=n>loss_fn</span><span class=p>,</span> <span class=n>has_aux</span><span class=o>=</span><span class=kc>True</span><span class=p>)(</span><span class=n>params</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>updates</span><span class=p>,</span> <span class=n>opt_state</span> <span class=o>=</span> <span class=n>tx</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>grads</span><span class=p>,</span> <span class=n>opt_state</span><span class=p>,</span> <span class=n>params</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>params</span> <span class=o>=</span> <span class=n>optax</span><span class=o>.</span><span class=n>apply_updates</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=n>updates</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>params</span><span class=p>,</span> <span class=n>opt_state</span><span class=p>,</span> <span class=n>metrics</span><span class=p>,</span> <span class=n>acts</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># Initialize optimizer</span>
</span></span><span class=line><span class=cl>  <span class=n>total_steps</span> <span class=o>=</span> <span class=mi>4_000</span>
</span></span><span class=line><span class=cl>  <span class=n>tx</span> <span class=o>=</span> <span class=n>optax</span><span class=o>.</span><span class=n>sgd</span><span class=p>(</span><span class=n>learning_rate</span><span class=o>=</span><span class=mf>0.01</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>opt_state</span> <span class=o>=</span> <span class=n>tx</span><span class=o>.</span><span class=n>init</span><span class=p>(</span><span class=n>params</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=c1># Training loop</span>
</span></span><span class=line><span class=cl>  <span class=n>step</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=n>step</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>total_steps</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>params</span><span class=p>,</span> <span class=n>opt_state</span><span class=p>,</span> <span class=n>metrics</span><span class=p>,</span> <span class=n>acts</span> <span class=o>=</span> <span class=n>train_step</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>,</span> <span class=n>opt_state</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>step</span> <span class=o>%</span> <span class=mi>200</span> <span class=o>==</span> <span class=mi>0</span> <span class=ow>or</span> <span class=n>step</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>      <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Step </span><span class=si>{</span><span class=n>step</span><span class=si>}</span><span class=s1>, Loss: </span><span class=si>{</span><span class=n>metrics</span><span class=p>[</span><span class=s2>&#34;loss&#34;</span><span class=p>]</span><span class=si>:</span><span class=s1>.4f</span><span class=si>}</span><span class=s1>, Acc: </span><span class=si>{</span><span class=n>metrics</span><span class=p>[</span><span class=s2>&#34;acc&#34;</span><span class=p>]</span><span class=si>:</span><span class=s1>.4f</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=n>params</span>
</span></span></code></pre></div><h3 id=classification-in-1d class="relative group">Classification in 1D <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#classification-in-1d aria-label=Anchor>#</a></span></h3><p>To match the 1D world of a number line, we will initialize our model with one dimension. The decision boundary of this neuron will be a point on the number line.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>brain</span> <span class=o>=</span> <span class=n>Brain</span><span class=p>(</span><span class=n>dimensions</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>rng</span><span class=p>,</span> <span class=n>rng_init</span> <span class=o>=</span> <span class=n>jax</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>rng</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>params</span> <span class=o>=</span> <span class=n>brain</span><span class=o>.</span><span class=n>init</span><span class=p>(</span><span class=n>rng_init</span><span class=p>,</span> <span class=n>jnp</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>x</span><span class=p>))[</span><span class=s2>&#34;params&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>params</span> <span class=o>=</span> <span class=n>fit</span><span class=p>(</span><span class=n>brain</span><span class=p>,</span> <span class=n>params</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span></span></code></pre></div><p>Observe how the activation manifold evolves over time. Since we cannot go anywhere but left or right, the best-accuracy scenario is to push the blue blob as far away from the red blobs as possible, leaving half of red blobs wrongly classified. This gives exactly 75% accuracy.</p><figure class="mx-auto my-0 rounded-md"><img src=/posts/dimensionality/manifold_1d.gif alt class="mx-auto my-0 rounded-md"></figure><h3 id=adding-a-virtual-dimension class="relative group">Adding a virtual dimension <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#adding-a-virtual-dimension aria-label=Anchor>#</a></span></h3><p>But what if we could think in 2D? Ah, then the problem becomes trivial - we achieve 100% accuracy. Activation space is now a 2D plane, and the decision boundary is a line. Notice how blue cluster is stretched out orthogonally to the red blobs.</p><figure class="mx-auto my-0 rounded-md"><img src=/posts/dimensionality/manifold_1d_to_2d.gif alt="1D to 2D Manifold" class="mx-auto my-0 rounded-md"><figcaption class=text-center>1D to 2D Manifold</figcaption></figure><h2 id=concentric-circles class="relative group">Concentric Circles <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#concentric-circles aria-label=Anchor>#</a></span></h2><p>Let&rsquo;s redo this exercise, but starting in 2D space. Consider a binary classification problem where the inner blue blob is class <code>1</code>, and the red ring is class <code>0</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>x</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>datasets</span><span class=o>.</span><span class=n>make_circles</span><span class=p>(</span><span class=n>n_samples</span><span class=o>=</span><span class=mi>2048</span><span class=p>,</span> <span class=n>noise</span><span class=o>=</span><span class=mf>0.15</span><span class=p>,</span> <span class=n>factor</span><span class=o>=</span><span class=mf>0.1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=p>(</span><span class=n>x</span> <span class=o>-</span> <span class=n>x</span><span class=o>.</span><span class=n>mean</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>))</span> <span class=o>/</span> <span class=n>x</span><span class=o>.</span><span class=n>std</span><span class=p>(</span><span class=n>axis</span><span class=o>=</span><span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>fig</span> <span class=o>=</span> <span class=n>px</span><span class=o>.</span><span class=n>scatter</span><span class=p>(</span><span class=n>x</span><span class=o>=</span><span class=n>x</span><span class=p>[:,</span> <span class=mi>0</span><span class=p>],</span> <span class=n>y</span><span class=o>=</span><span class=n>x</span><span class=p>[:,</span> <span class=mi>1</span><span class=p>],</span> <span class=n>color</span><span class=o>=</span><span class=n>y</span><span class=p>,</span> <span class=n>color_continuous_scale</span><span class=o>=</span><span class=s1>&#39;RdBu&#39;</span><span class=p>,</span> <span class=n>opacity</span><span class=o>=</span><span class=mf>0.5</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=o>.</span><span class=n>update_layout</span><span class=p>(</span><span class=n>width</span><span class=o>=</span><span class=mi>600</span><span class=p>,</span> <span class=n>height</span><span class=o>=</span><span class=mi>600</span><span class=p>,</span> <span class=n>coloraxis_showscale</span><span class=o>=</span><span class=kc>False</span><span class=p>,</span> <span class=n>template</span><span class=o>=</span><span class=s2>&#34;plotly_white&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>fig</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></div><figure class="mx-auto my-0 rounded-md"><img src=/posts/dimensionality/circles.png alt="2D Circles" class="mx-auto my-0 rounded-md"><figcaption class=text-center>2D Circles</figcaption></figure><h3 id=classification-in-2d class="relative group">Classification in 2D <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#classification-in-2d aria-label=Anchor>#</a></span></h3><p>To match the 2D world, we will initialize our model with two dimensions. Visualizing the activation manifold of this 2D model shows the learnt decision boundary. Since activation manifold is 2D, our decision boundary will be a line.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>brain</span> <span class=o>=</span> <span class=n>Brain</span><span class=p>(</span><span class=n>dimensions</span><span class=o>=</span><span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>rng</span><span class=p>,</span> <span class=n>rng_init</span> <span class=o>=</span> <span class=n>jax</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>rng</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>params</span> <span class=o>=</span> <span class=n>brain</span><span class=o>.</span><span class=n>init</span><span class=p>(</span><span class=n>rng_init</span><span class=p>,</span> <span class=n>jnp</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>x</span><span class=p>))[</span><span class=s2>&#34;params&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>params</span> <span class=o>=</span> <span class=n>fit</span><span class=p>(</span><span class=n>brain</span><span class=p>,</span> <span class=n>params</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span></span></code></pre></div><figure class="mx-auto my-0 rounded-md"><img src=/posts/dimensionality/manifold_2d.gif alt="2D Manifold Evolution" class="mx-auto my-0 rounded-md"><figcaption class=text-center>2D Manifold Evolution</figcaption></figure><p>This behavior is similar to the case above where 1D line was expanded to 2D. The entire <code>blue</code> cluster is cornered with <code>red</code> ring stretched out along perpendicular directions. We achieve \(\sim\) 85% accuracy.</p><p>But we don&rsquo;t achieve 100% accuracy on this problem. No line segment can partition these two clusters in 2D space. The outer ring fully covers the inner one. It is mathematically impossible to do so, without using additional dimensions of space. The fact that despite topological limitations, this 2D model crossed \(\sim\) 85% on this dataset tells us how far even a 2D model can twist the data manifold for classification.</p><h3 id=adding-a-virtual-dimension-1 class="relative group">Adding a virtual dimension <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#adding-a-virtual-dimension-1 aria-label=Anchor>#</a></span></h3><p>Let&rsquo;s see what happens when our model is given one extra dimension than the data manifold resides in. Our activation manifold will now be 3D.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>brain</span> <span class=o>=</span> <span class=n>Brain</span><span class=p>(</span><span class=n>dimensions</span><span class=o>=</span><span class=mi>3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>rng</span><span class=p>,</span> <span class=n>rng_init</span> <span class=o>=</span> <span class=n>jax</span><span class=o>.</span><span class=n>random</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>rng</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>params</span> <span class=o>=</span> <span class=n>brain</span><span class=o>.</span><span class=n>init</span><span class=p>(</span><span class=n>rng_init</span><span class=p>,</span> <span class=n>jnp</span><span class=o>.</span><span class=n>zeros_like</span><span class=p>(</span><span class=n>x</span><span class=p>))[</span><span class=s2>&#34;params&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>params</span> <span class=o>=</span> <span class=n>fit</span><span class=p>(</span><span class=n>brain</span><span class=p>,</span> <span class=n>params</span><span class=p>,</span> <span class=n>x</span><span class=p>,</span> <span class=n>y</span><span class=p>)</span>
</span></span></code></pre></div><iframe src=/manifold_3d.html width=100% height=480 frameborder=0></iframe><p>The decision boundary is now a plane, which can separate the two classes with \(\sim\) 100% accuracy. This is because the model now stretches the center cluster out across z-axis, and slices a plane orthogonal to it.</p></div></section><footer class="max-w-prose pt-8 print:hidden"><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="group flex" href=/posts/starship-score/><span class="me-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"><span class="ltr:inline rtl:hidden">&larr;</span><span class="ltr:hidden rtl:inline">&rarr;</span></span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">'Notes' of a Launch</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2024-12-21 00:00:00 +0000 UTC">21 December 2024</time>
</span></span></a></span><span><a class="group flex text-right" href=/posts/graph-search/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">Graph Search</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2024-08-27 00:00:00 +0000 UTC">27 August 2024</time>
</span></span><span class="ms-2 text-neutral-700 transition-transform group-hover:-translate-x-[-2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"><span class="ltr:inline rtl:hidden">&rarr;</span><span class="ltr:hidden rtl:inline">&larr;</span></span></a></span></div></div></footer></article></main><div class="pointer-events-none absolute bottom-0 end-0 top-[100vh] w-12" id=to-top hidden=true><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div><footer class="py-10 print:hidden"><nav class="pb-4 text-base font-medium text-neutral-500 dark:text-neutral-400"><ul class="flex list-none flex-col sm:flex-row"><li class="group mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0"><a href=/tags/ title><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">Tags</span></a></li><li class="group mb-1 text-end sm:mb-0 sm:me-7 sm:last:me-0"><a href=https://drive.google.com/file/d/1blFQIqhagkHfd3sqsjawCyPCvl0Evrtw/view title><span class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2">CV</span></a></li></ul></nav><div class="flex items-center justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">Copyright © 2025 Karan Shah. If you copy this, may your WiFi become unstable.</p></div><div class="flex flex-row items-center"><div class="me-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"><button id=appearance-switcher-0 type=button aria-label="appearance switcher"><div class="flex h-12 w-12 items-center justify-center dark:hidden" title="Switch to dark appearance"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="hidden h-12 w-12 items-center justify-center dark:flex" title="Switch to light appearance"><span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div></div></footer><div id=search-wrapper class="invisible fixed inset-0 z-50 flex h-screen w-screen cursor-default flex-col bg-neutral-500/50 p-4 backdrop-blur-sm dark:bg-neutral-900/50 sm:p-6 md:p-[10vh] lg:p-[12vh]" data-url=https://masterskepticista.github.io/><div id=search-modal class="top-20 mx-auto flex min-h-0 w-full max-w-3xl flex-col rounded-md border border-neutral-200 bg-neutral shadow-lg dark:border-neutral-700 dark:bg-neutral-800"><header class="relative z-10 flex flex-none items-center justify-between px-2"><form class="flex min-w-0 flex-auto items-center"><div class="flex h-8 w-8 items-center justify-center text-neutral-400"><span class="icon relative inline-block px-1 align-text-bottom"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="search" class="svg-inline--fa fa-search fa-w-16" role="img" viewBox="0 0 512 512"><path fill="currentcolor" d="M505 442.7 405.3 343c-4.5-4.5-10.6-7-17-7H372c27.6-35.3 44-79.7 44-128C416 93.1 322.9.0 208 0S0 93.1.0 208s93.1 208 208 208c48.3.0 92.7-16.4 128-44v16.3c0 6.4 2.5 12.5 7 17l99.7 99.7c9.4 9.4 24.6 9.4 33.9.0l28.3-28.3c9.4-9.4 9.4-24.6.1-34zM208 336c-70.7.0-128-57.2-128-128 0-70.7 57.2-128 128-128 70.7.0 128 57.2 128 128 0 70.7-57.2 128-128 128z"/></svg></span></div><input type=search id=search-query class="mx-1 flex h-12 flex-auto appearance-none bg-transparent focus:outline-dotted focus:outline-2 focus:outline-transparent" placeholder=Search tabindex=0></form><button id=close-search-button class="flex h-8 w-8 items-center justify-center text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400" title="Close (Esc)">
<span class="icon relative inline-block px-1 align-text-bottom"><svg viewBox="0 0 320 512"><path fill="currentcolor" d="M310.6 361.4c12.5 12.5 12.5 32.75.0 45.25C304.4 412.9 296.2 416 288 416s-16.38-3.125-22.62-9.375L160 301.3 54.63 406.6C48.38 412.9 40.19 416 32 416S15.63 412.9 9.375 406.6c-12.5-12.5-12.5-32.75.0-45.25l105.4-105.4L9.375 150.6c-12.5-12.5-12.5-32.75.0-45.25s32.75-12.5 45.25.0L160 210.8l105.4-105.4c12.5-12.5 32.75-12.5 45.25.0s12.5 32.75.0 45.25l-105.4 105.4L310.6 361.4z"/></svg></span></button></header><section class="flex-auto overflow-auto px-2"><ul id=search-results></ul></section></div></div></div></body></html>